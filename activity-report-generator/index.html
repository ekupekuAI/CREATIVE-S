<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Activity Report Generator</title>

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <!-- html2canvas + jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <!-- Custom Styles -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="../css/ui-effects.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Serif:wght@400;600&family=Merriweather:wght@300;400;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- ===== NAVBAR ===== -->
  <nav class="navbar navbar-expand-lg bg-body-tertiary shadow-sm sticky-top">
    <script>
    window.AppStorage = window.AppStorage || {
      async save(key, value) {
        try { localStorage.setItem(key, JSON.stringify(value)); } catch (e) {}
      },
      async load(key, def=null) {
        try { 
          const v = localStorage.getItem(key);
          return v ? JSON.parse(v) : def;
        } catch(e) { return def; }
      },
      async remove(key) {
        try { localStorage.removeItem(key); } catch(e) {}
      }
    };
    </script>
    <div class="container-fluid">
      <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="#">
        <i class="fa-solid fa-file-pen"></i> Activity Report Generator
      </a>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-outline-dark btn-sm" id="btnDarkMode" title="Toggle Dark Mode">
          <i class="fa-solid fa-moon"></i>
        </button>
        <input type="file" id="templateUpload" accept=".pdf,.docx,.jpg,.jpeg,.png" class="d-none">
        <button class="btn btn-outline-primary btn-sm" id="btnAnalyzeTemplate" title="AI Analyze Template">
          <i class="fa-solid fa-wand-magic-sparkles me-1"></i> AI Analyze
        </button>
      </div>
    </div>
  </nav>

  <!-- ===== MAIN CONTENT ===== -->
  <div class="container-fluid">
    <div class="row">
      <!-- ===== SIDEBAR ===== -->
      <aside class="col-12 col-lg-3 col-xl-2 p-3 sidebar">
        <div class="list-group" id="navTabs">
          <a href="#" class="list-group-item list-group-item-action active" data-tab="templates">
            <i class="fa-solid fa-layer-group me-2"></i> Templates
          </a>
          <a href="#" class="list-group-item list-group-item-action" data-tab="editor">
            <i class="fa-solid fa-pen-to-square me-2"></i> Editor
          </a>
          <a href="#" class="list-group-item list-group-item-action" data-tab="preview">
            <i class="fa-solid fa-eye me-2"></i> Preview
          </a>
          <a href="#" class="list-group-item list-group-item-action" data-tab="export">
            <i class="fa-solid fa-file-export me-2"></i> Export
          </a>
        </div>
        <hr>
        <div class="small text-muted">Autosaves automatically in your browser.</div>
      </aside>

      <!-- ===== MAIN AREA ===== -->
      <main class="col-12 col-lg-9 col-xl-10 p-3">
        <!-- Template Selection -->
        <section id="tab-templates" class="tab-section">
          <div class="row g-3" id="templateGallery"></div>
        </section>

        <!-- Editor Panel -->
        <section id="tab-editor" class="tab-section d-none">
          <div class="row g-3">
            <div class="col-lg-8">
              <div class="card shadow-sm p-3">
                <h5>Report Editor</h5>
                <div id="reportCanvas" contenteditable="true" class="editable-area border rounded p-3">
                  <h3 class="text-center">Activity Report Title</h3>
                  <p class="text-muted text-center">Organization / Department</p>
                  <hr>
                  <h5>1. Introduction</h5>
                  <p>Enter activity introduction here...</p>
                  <h5>2. Objective</h5>
                  <p>Describe objectives...</p>
                  <h5>3. Summary</h5>
                  <p>Summarize event outcomes...</p>
                  <h5>4. Participants</h5>
                  <ul><li>Student A</li><li>Student B</li><li>Student C</li></ul>
                  <h5>5. Date & Venue</h5>
                  <p>Held on DD-MM-YYYY at Auditorium.</p>
                  <h5>6. Conclusion</h5>
                  <p>Write closing remarks here.</p>
                </div>
              </div>
            </div>

            <div class="col-lg-4">
              <div class="card shadow-sm p-3">
                <h6>Customization</h6>
                <label class="form-label mt-2">Upload Logo</label>
                <input type="file" id="logoUpload" accept="image/*" class="form-control form-control-sm mb-2">
                <div class="d-flex gap-2 align-items-center">
                  <label class="form-label mb-0" style="width:36%">Logo Align</label>
                  <select id="logoAlign" class="form-select form-select-sm" style="width:64%">
                    <option value="center">Center</option>
                    <option value="left">Left</option>
                    <option value="right">Right</option>
                  </select>
                </div>
                <label class="form-label mt-3">Logo Size</label>
                <input type="range" id="logoSize" min="36" max="140" value="60" class="form-range">
                <button class="btn btn-outline-secondary btn-sm w-100 mt-2" id="btnGenLogo"><i class="fa-solid fa-magic me-1"></i>Generate Logo</button>
                <label class="form-label mt-2">Font Family</label>
                <select id="fontFamily" class="form-select">
                  <option value="Poppins">Poppins</option>
                  <option value="Roboto Serif">Roboto Serif</option>
                  <option value="Merriweather">Merriweather</option>
                  <option value="Montserrat">Montserrat</option>
                </select>

                <label class="form-label mt-3">Font Size</label>
                <input type="range" id="fontSize" min="12" max="28" value="16" class="form-range">

                <label class="form-label mt-3">Text Alignment</label>
                <select id="textAlign" class="form-select">
                  <option value="left">Left</option>
                  <option value="center">Center</option>
                  <option value="justify">Justify</option>
                </select>

                <label class="form-label mt-3">Text Color</label>
                <input type="color" id="textColor" class="form-control form-control-color" value="#000000">

                <hr>
                <button class="btn btn-outline-secondary btn-sm w-100 mt-2" id="btnAddSection">
                  <i class="fa-solid fa-plus me-1"></i> Add Section
                </button>
                <button class="btn btn-outline-danger btn-sm w-100 mt-2" id="btnResetReport">
                  <i class="fa-solid fa-rotate-left me-1"></i> Reset
                </button>

                <hr>
                <label class="form-label mt-3">AI Analyze Raw Text</label>
                <textarea id="rawTextInput" class="form-control" rows="4" placeholder="Paste the complete activity report text here..."></textarea>
                <button class="btn btn-primary btn-sm w-100 mt-2" id="btnAnalyzeRawText">
                  <i class="fa-solid fa-brain me-1"></i> Analyze & Auto-Fill
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Preview Section -->
        <section id="tab-preview" class="tab-section d-none">
          <div class="card shadow-sm p-3">
            <h5>Live Preview</h5>
            <iframe id="previewFrame" class="w-100" style="height:80vh;border:none;background:#fff;"></iframe>
          </div>
        </section>

        <!-- Export Section -->
        <section id="tab-export" class="tab-section d-none">
          <div class="card shadow-sm p-3">
            <h5>Export Options</h5>
            <div class="row g-3 mt-2">
              <div class="col-md-4">
                <button class="btn btn-outline-primary w-100" id="btnPdf"><i class="fa-solid fa-file-pdf me-1"></i> Download PDF</button>
              </div>
              <div class="col-md-4">
                <button class="btn btn-outline-primary w-100" id="btnWord"><i class="fa-solid fa-file-word me-1"></i> Download DOCX</button>
              </div>
              <div class="col-md-4">
                <button class="btn btn-outline-primary w-100" id="btnPng"><i class="fa-solid fa-image me-1"></i> Export PNG</button>
              </div>
            </div>
            <hr>
            <div class="form-check form-switch mt-2">
              <input class="form-check-input" type="checkbox" id="addWatermark">
              <label class="form-check-label" for="addWatermark">Add “Official Copy” watermark</label>
            </div>
            <div class="text-muted small mt-3">Multi-format export with watermark & print optimization</div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- JS IMPORTS -->
  <script src="js/ai-hooks.js"></script>
  <script src="js/report.js"></script>
  <script src="js/editor.js"></script>
  <script src="js/export.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
